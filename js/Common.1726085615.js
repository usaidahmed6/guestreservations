var Common={initDropdowns:function(){$('div.dropdown:not(".no-auto-init")').each(function(){if($(this).find('select')[0]){Common.initDropdown($(this).find('select'))}else{Common.initDropdown($(this));}});},initDropdown:function(dropdown){dropdown.removeClass('no-auto-init');if(dropdown.hasClass('js-currency')){return dropdown.grDropdown({shortLabelDataAttr:'short-label'});}
return dropdown.grDropdown();},mixpanelExists:function(method='track'){return typeof mixpanel==='object'&&typeof mixpanel[method]==='function';},mixpanelTrack:function(eventName,eventData,options=null){eventData=this._mixpanelEventData(eventData);if(this.mixpanelExists()){if(!options){mixpanel.track(eventName,eventData);}
else{mixpanel.track(eventName,eventData,options);}}else{console.log('[mixpanel.track]',eventName,eventData);}},getABTestData:function(abTestName){return abTests.find(function(abTest){return abTest.test_name===abTestName;});},mixpanelTrackLinks:function(element,eventName,eventData){if(element.length){eventData=this._mixpanelEventData(eventData);if(this.mixpanelExists('track_links')){mixpanel.track_links(element,eventName,eventData);}else{var logStr='[mixpanel.track_links] '+element.attr('href');console.log(logStr,'"'+eventName+'"',eventData);}}},loggedInPropVal:function(loggedIn){return loggedIn?'true':'';},_mixpanelEventData:function(eventData={}){if($('#privacy-message').length){eventData['Privacy Banner Displayed']='Yes';}
abTests.forEach(abTest=>{if(abTest['mp_property_name']!=''){eventData[abTest['mp_property_name']]=abTest['mp_value'];}});const result={...eventData,'Customer type':GR.globals.customerType,'hostname':GR.globals.serverHost,'device':GR.globals.device,'Viewport Width':$(window).width(),'Viewport Height':$(window).height(),'sid':GR.globals.sid,'Bot Score':GR.globals.botScore,'Verified Bot':GR.globals.verifiedBot,'Threat Score':GR.globals.threatScore,'IP Address':GR.globals.ipAddress,};if(GR.globals.userAttributionEnabled&&GR.globals.isUserAttributionBGroup){const userId=localStorage.getItem('userId')
const sessionId=sessionStorage.getItem('sessionId')
if(userId){result['User ID']=userId}
if(sessionId){result['Session ID']=sessionId}}
return result;},scrollToElement:function(el,addOffset,callbackfunc,toScreenCenter){addOffset=addOffset===undefined?0:addOffset;toScreenCenter=toScreenCenter===undefined?0:toScreenCenter;var gotoY=el.offset().top;gotoY+=Math.abs(addOffset)>0?addOffset:0;var magicIphoneOffset=5;gotoY-=toScreenCenter?$(window).height()/2-el.outerHeight()/2-magicIphoneOffset:0;gotoY=gotoY>0?gotoY:0;this.scrollTo(gotoY,700,callbackfunc);},scrollTo:function(gotoY,speed,callbackfunc){if(typeof callbackfunc==="function"){$('html, body').animate({scrollTop:gotoY},speed).promise().then(callbackfunc);}else{$('html, body').animate({scrollTop:gotoY},speed);}},detectIE:function(){var ua=window.navigator.userAgent;var ie=ua.search(/(MSIE|Trident|Edge)/);return ie>-1;},detectMobile:function(){var mobileIndicator=$('#mobile-indicator');return mobileIndicator.length&&mobileIndicator.css('position')==="relative";},detectTablet:function(){var mobileIndicator=$('#mobile-indicator');return mobileIndicator.length&&mobileIndicator.css('position')==="absolute";},initHotelsImagesErrors:function(){$('img.js-prop-photo[data-src]').each(function(){var image=$(this);var downloadingImage=new Image();downloadingImage.onload=function(){image.attr('src',image.data('src')).removeClass('d-none');};downloadingImage.onerror=function(){image.removeClass('d-none');};downloadingImage.src=image.data('src');image.removeAttr('data-src');});},hideDatepickers:function(){$("input#check_in").datepicker("hide");$("input#check_out").datepicker("hide");},dropElementsEventsListeners:function(select){select.each(function(){var el=$(this);var elCloned=el.clone();elCloned.addClass("control-no-events");el.replaceWith(elCloned);});},setCookie:function(name,value,days){var expires="";if(days){var date=new Date();date.setTime(date.getTime()+(days*24*60*60*1000));expires="; expires="+date.toUTCString();}
document.cookie=name+"="+(value||"")+expires+"; path=/";},setTestCookie:function(testName){return $.ajax({type:"POST",url:"/site/setcookie",data:{testName:testName},success:function(data){for(let entry of abTests){if(entry.cookie_name===data.name){return}}
abTests.push({mp_property_name:data.mp_property_name,mp_value:data.mp_value,cookie_name:data.name,test_name:testName,variant_id:data.value,})},error:function(err){console.error(err);}});},getTestCookie:function(testName){for(let x=0;x<abTests.length;x++){if(abTests[x].test_name===testName){return abTests[x]}}
return false},checkFlag:function(flagName){return $.ajax({type:"POST",url:"/site/checkflag",data:{flagName:flagName},success:function(data){return data},error:function(err){console.error(err);}});},getUuid:function(){return 'tttttttt-tttt-7xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(c){const r=Math.trunc(Math.random()*16);const v=c=='x'?r:(r&0x3|0x8);return v.toString(16);}).replace(/^[t]{8}-[t]{4}/,function(){const unixtimestamp=Date.now().toString(16).padStart(12,'0');return unixtimestamp.slice(0,8)+'-'+unixtimestamp.slice(8);});},};var onErrorRoomImage=function(image){var photo=$(image);if(photo.attr('data-nophoto')!==undefined){var noPhoto=photo.attr('data-nophoto');photo.removeAttr('data-nophoto').attr('src',noPhoto);}};var debug=function(){const debugTable={serverHost:Main.settings.serverHost,userCountry:Main.settings.userCountry,device:Main.settings.device,sid:sid,mixpanelDeviceId:mixpanelDeviceId,}
console.table(debugTable);console.table(abTests);}